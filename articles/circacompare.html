<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="circacompare">
<title>circacompare • circacompare</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="circacompare">
<meta property="og:description" content="circacompare">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">circacompare</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/circacompare.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>circacompare</h1>
            
      
      
      <div class="d-none name"><code>circacompare.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="updates-since-the-initial-release-circacompare-0-1-0-and-bioinformatics-journal-article-">Updates since the initial release (circacompare 0.1.0) and <a href="https://doi.org/10.1093/bioinformatics/btz730" class="external-link">Bioinformatics
journal article</a>.<a class="anchor" aria-label="anchor" href="#updates-since-the-initial-release-circacompare-0-1-0-and-bioinformatics-journal-article-"></a>
</h2>
<p>There have been several added features to the current version of the
circacompare package since the publication in Bioinformatics and initial
release on CRAN. Many of the possible uses for this package are not
described in the manuscript. The approach to compare two groups of
rhythmic data, regarding mesor, amplitude and phase, as described in the
manuscript, can be completed by using the <code><a href="../reference/circacompare.html">circacompare()</a></code>
function under the default settings in any version of the package. In
addition to this, the current version offers approaches to:</p>
<ul>
<li>Perform analysis on a single rhythmic dataset to estimate its mesor,
amplitude and phase.</li>
<li>Choose to use a known period (user-determined) or to let the model
estimate the period from the data.</li>
<li>Add parameters to estimate the exponential decay in any of the
rhythmic characteristics.</li>
<li>Use a mixed-model instead of a fixed effects model to take into
account within-subject correlation regarding any set of rhythmic
characteristics.</li>
<li>Perform a comparison between groups regarding all or a subset of
rhythmic characteristics.</li>
</ul>
</div>
<div class="section level2">
<h2 id="introduction-to-circacompare-using-fixed-effects-only-models-and-no-customized-model-parametrization">Introduction to circacompare, using fixed-effects only models and no
customized model parametrization<a class="anchor" aria-label="anchor" href="#introduction-to-circacompare-using-fixed-effects-only-models-and-no-customized-model-parametrization"></a>
</h2>
<div class="section level3">
<h3 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h3>
<p>The first part of using circacompare to analyse your data is to
ensure that your data is formatted correctly. All of the functions
within the circacompare package expect that your data will be of a tidy
format, meaning that each row will contain only one observation, with
columns to represent the time, group or subject ID for that
observation.</p>
<p>In the simplest case, you may have a single rhythm for which you’re
wanting to estimate the mesor, amplitude and phase. In this case, you
only need a variable for the time of observation and the outcome which
you’re wanting to model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rwparsons.github.io/circacompare/">circacompare</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">data_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_data.html">make_data</a></span><span class="op">(</span>k1 <span class="op">=</span> <span class="fl">0</span>, alpha1 <span class="op">=</span> <span class="fl">0</span>, phi1 <span class="op">=</span> <span class="fl">0</span>, noise_sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"measure"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_single</span><span class="op">)</span></span>
<span><span class="co">#&gt;   time    measure</span></span>
<span><span class="co">#&gt; 1    1 11.0302167</span></span>
<span><span class="co">#&gt; 2    2  8.0955559</span></span>
<span><span class="co">#&gt; 3    3  7.4341962</span></span>
<span><span class="co">#&gt; 4    4  5.6328626</span></span>
<span><span class="co">#&gt; 5    5  2.9924588</span></span>
<span><span class="co">#&gt; 6    6 -0.1061245</span></span></code></pre></div>
<p>In the case that you have data from two groups and you’re wishing to
determine the differences in mesor, amplitude, or phase between them,
you will need an additional column (with two possible values)
representing the groups.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_grouped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_data.html">make_data</a></span><span class="op">(</span>phi1 <span class="op">=</span> <span class="fl">6</span>, noise_sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_grouped</span><span class="op">)</span></span>
<span><span class="co">#&gt;   time  measure group</span></span>
<span><span class="co">#&gt; 1    1 8.527520    g1</span></span>
<span><span class="co">#&gt; 2    2 7.201040    g1</span></span>
<span><span class="co">#&gt; 3    3 7.151050    g1</span></span>
<span><span class="co">#&gt; 4    4 5.653204    g1</span></span>
<span><span class="co">#&gt; 5    5 3.789156    g1</span></span>
<span><span class="co">#&gt; 6    6 1.044751    g1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">data_grouped</span><span class="op">)</span></span>
<span><span class="co">#&gt;    time  measure group</span></span>
<span><span class="co">#&gt; 91   43 10.95842    g2</span></span>
<span><span class="co">#&gt; 92   44 13.66312    g2</span></span>
<span><span class="co">#&gt; 93   45 14.43497    g2</span></span>
<span><span class="co">#&gt; 94   46 15.00277    g2</span></span>
<span><span class="co">#&gt; 95   47 17.20176    g2</span></span>
<span><span class="co">#&gt; 96   48 16.09730    g2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="circa_single">
<code>circa_single()</code><a class="anchor" aria-label="anchor" href="#circa_single"></a>
</h3>
<p><code><a href="../reference/circa_single.html">circa_single()</a></code> is used to analyse a single rhythm and
provide estimates of its mesor, amplitude and phase.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/circa_single.html">circa_single</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data_single</span>, col_time <span class="op">=</span> <span class="st">"time"</span>, col_outcome <span class="op">=</span> <span class="st">"measure"</span>, period <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt; $fit</span></span>
<span><span class="co">#&gt; Nonlinear regression model</span></span>
<span><span class="co">#&gt;   model: measure ~ k + (alpha) * cos((1/period) * time_r - (phi))</span></span>
<span><span class="co">#&gt;    data: x</span></span>
<span><span class="co">#&gt;        k    alpha      phi </span></span>
<span><span class="co">#&gt;  0.05322 10.07049  0.01645 </span></span>
<span><span class="co">#&gt;  residual sum-of-squares: 101.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations to convergence: 5 </span></span>
<span><span class="co">#&gt; Achieved convergence tolerance: 1.141e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $summary</span></span>
<span><span class="co">#&gt;         parameter        value</span></span>
<span><span class="co">#&gt; 1      rhythmic_p 2.524709e-80</span></span>
<span><span class="co">#&gt; 2           mesor 5.322133e-02</span></span>
<span><span class="co">#&gt; 3       amplitude 1.007049e+01</span></span>
<span><span class="co">#&gt; 4   phase_radians 1.645014e-02</span></span>
<span><span class="co">#&gt; 5 peak_time_hours 6.283491e-02</span></span>
<span><span class="co">#&gt; 6          period 2.400000e+01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plot</span></span></code></pre></div>
<p><img src="circacompare_files/figure-html/unnamed-chunk-5-1.png" width="480"></p>
<p>The fitted model is included as the first element of the results.</p>
<p>It fits a model: <code>measure ~ k + alpha * cos(time_r - phi)</code>
where</p>
<ul>
<li><p><code>measure</code> is the outcome of interest</p></li>
<li><p><code>k</code> is the mesor</p></li>
<li><p><code>alpha</code> is the amplitude</p></li>
<li><p><code>time_r</code> is the time in radian-hours, and</p></li>
<li><p><code>phi</code> is the amount of phase shift (from
<code>time=0</code>) in radian-hours.</p></li>
</ul>
<p>The parameter estimates of time in radian-hours (<code>time_r</code>
and <code>phi</code>) are converted back to hours and reported in the
<code>data.frame</code> (second element of list) and x-axis of the graph
(third item of list)</p>
</div>
<div class="section level3">
<h3 id="circacompare">
<code>circacompare()</code><a class="anchor" aria-label="anchor" href="#circacompare"></a>
</h3>
<p><code><a href="../reference/circacompare.html">circacompare()</a></code> is used to analyse a dataset with two
groups of rhythmic data. It fits a model to estimate and statistically
support differences in mesor, amplitude and phase between the two
groups.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/circacompare.html">circacompare</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data_grouped</span>, col_time <span class="op">=</span> <span class="st">"time"</span>, col_group <span class="op">=</span> <span class="st">"group"</span>, col_outcome <span class="op">=</span> <span class="st">"measure"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result2</span></span>
<span><span class="co">#&gt; $plot</span></span></code></pre></div>
<p><img src="circacompare_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $summary</span></span>
<span><span class="co">#&gt;                                   parameter         value</span></span>
<span><span class="co">#&gt; 1  Presence of rhythmicity (p-value) for g1  3.232079e-41</span></span>
<span><span class="co">#&gt; 2  Presence of rhythmicity (p-value) for g2  3.863382e-50</span></span>
<span><span class="co">#&gt; 3                         g1 mesor estimate -1.842953e-01</span></span>
<span><span class="co">#&gt; 4                         g2 mesor estimate  2.921261e+00</span></span>
<span><span class="co">#&gt; 5                 Mesor difference estimate  3.105556e+00</span></span>
<span><span class="co">#&gt; 6              P-value for mesor difference  2.041190e-29</span></span>
<span><span class="co">#&gt; 7                     g1 amplitude estimate  9.767675e+00</span></span>
<span><span class="co">#&gt; 8                     g2 amplitude estimate  1.408205e+01</span></span>
<span><span class="co">#&gt; 9             Amplitude difference estimate  4.314378e+00</span></span>
<span><span class="co">#&gt; 10         P-value for amplitude difference  6.866192e-29</span></span>
<span><span class="co">#&gt; 11                       g1 peak time hours  2.396898e+01</span></span>
<span><span class="co">#&gt; 12                       g2 peak time hours  2.294131e+01</span></span>
<span><span class="co">#&gt; 13                Phase difference estimate -1.027669e+00</span></span>
<span><span class="co">#&gt; 14          P-value for difference in phase  1.138807e-19</span></span>
<span><span class="co">#&gt; 15                   Shared period estimate  2.400000e+01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fit</span></span>
<span><span class="co">#&gt; Nonlinear regression model</span></span>
<span><span class="co">#&gt;   model: measure ~ (k + k1 * x_group) + ((alpha + alpha1 * x_group)) *     cos((1/period) * time_r - ((phi + phi1 * x_group)))</span></span>
<span><span class="co">#&gt;    data: x</span></span>
<span><span class="co">#&gt;       k      k1   alpha  alpha1     phi    phi1 </span></span>
<span><span class="co">#&gt; -0.1843  3.1056  9.7677  4.3144 12.5582 -0.2690 </span></span>
<span><span class="co">#&gt;  residual sum-of-squares: 74.18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations to convergence: 4 </span></span>
<span><span class="co">#&gt; Achieved convergence tolerance: 7.333e-08</span></span></code></pre>
<p>This fits a model:
<code>measure ~ k + k1 * x_group + (alpha + alpha1 * x_group) * cos(time_r - (phi + phi1 * x_group))</code>
where</p>
<ul>
<li><p><code>x_group</code> is a dummy variable which represents the
different groups: <code>x_group=0</code> and <code>x_group=1</code> for
the first and second group, respectively</p></li>
<li><p><code>measure</code> is the outcome of interest</p></li>
<li><p><code>k</code> is the mesor of the first group</p></li>
<li><p><code>k1</code> is the difference in mesor between the first and
second group</p></li>
<li><p><code>alpha</code> is the amplitude of the first group</p></li>
<li><p><code>alpha1</code> is the difference in amplitude between the
first and second group</p></li>
<li><p><code>time_r</code> is the time in radian-hours</p></li>
<li><p><code>phi</code> is the amount of phase-shift of the first group
(from <code>time=0</code>) in radian-hours, and</p></li>
<li><p><code>phi1</code> is the amount of phase-shift of the second
group from the first group in radian-hours</p></li>
</ul>
<p>The time-related parameter estimates (<code>phi</code> and
<code>phi1</code>) are converted from radian-hours to hours before being
used to report <code>g1 peak time</code>, <code>g2 peak time</code>, and
<code>phase difference estimate</code>.</p>
<p>The second item of the <code>result2</code> list is a data.frame
containing the important results from the model. It returns estimates
and for the rhythmic parameters for each group as well as the p-values
associated with those which represent differences between the groups
(<code>k1</code>, <code>alpha1</code>, <code>phi1</code>).</p>
<p>More detailed outputs from the model can be obtained from the model
itself</p>
</div>
<div class="section level3">
<h3 id="when-to-use-what">When to use what<a class="anchor" aria-label="anchor" href="#when-to-use-what"></a>
</h3>
<p>If you are looking to estimate the rhythmic parameters of a single
group, use <code><a href="../reference/circa_single.html">circa_single()</a></code>. If you are looking to estimate
the differences between two rhythmic datasets, use
<code><a href="../reference/circacompare.html">circacompare()</a></code></p>
<p>If your data has a hierarchical structure, a mixed model may be more
appropriate (keep reading). This may be the case if you have repeated
measurements from the same subjects/tissues over time, for example. In
this case, consider the equivalents of the above:
<code><a href="../reference/circa_single_mixed.html">circa_single_mixed()</a></code> and <code><a href="../reference/circacompare_mixed.html">circacompare_mixed()</a></code>.
In addition to what has been described, these mixed models require the
user to specify which parameters ought to have a random effect and the
identifying column (<code>col_id</code>) for this hierarchical
structure.</p>
</div>
</div>
<div class="section level2">
<h2 id="mixed-model-variants-and-how-to-customize-the-parameterization-of-the-model">Mixed-model variants and how to customize the parameterization of
the model<a class="anchor" aria-label="anchor" href="#mixed-model-variants-and-how-to-customize-the-parameterization-of-the-model"></a>
</h2>
<div class="section level3">
<h3 id="firstly-a-mention-on-control-and-model-parameters">Firstly, a mention on <code>control</code> and model parameters<a class="anchor" aria-label="anchor" href="#firstly-a-mention-on-control-and-model-parameters"></a>
</h3>
<p>When we refer to parameters, we are talking about covariates in the
model being fit that will represent rhythmic characteristics of the
data. Arguments are what the user (you) supplies when calling the
function.</p>
<p>For all of the circacompare functions, the argument
<code>control</code> contains a list of optional arguments that can be
used to modify the parameterization of the model being fit. This list
includes <code>main_params</code>, <code>decay_params</code>,
<code>rand_params</code>, <code>group_params</code> which are all
character vectors. The naming conventions of values within these vectors
is consistent with our model formulas described earlier: “k” for mesor,
“alpha” for amplitude, “phi” for phase. The additional parameter we
introduce here is “tau” for period.</p>
<p>In <code><a href="../reference/circa_single.html">circa_single()</a></code> there are no groups to model
differences between so <code>group_params</code> is ignored. Since there
are also no random effects, <code>rand_params</code> is also ignored.
Only the <code>main_params</code> and <code>decay_params</code> are
considered. Similarly, <code><a href="../reference/circacompare.html">circacompare()</a></code> considers
<code>main_params</code>, <code>decay_params</code>, and ignores
<code>rand_params()</code>, but also includes <code>group_params</code>
as it is used to consider the differences between groups. Only the
mixed-model variants of these two functions,
<code><a href="../reference/circa_single_mixed.html">circa_single_mixed()</a></code> and <code><a href="../reference/circacompare_mixed.html">circacompare_mixed()</a></code>,
consider <code>rand_params</code>.</p>
<p>For the <code>main_params</code> vector, the possible values are
<code>k</code> for the mesor, <code>alpha</code> for amplitude,
<code>phi</code> for phase, and <code>tau</code>. The only optional
parameter of these in the <code>main_params</code> is <code>tau</code>,
the rest must be included at all times. The default is
<code>main_params=c("k", "alpha", "phi")</code>, which excludes the
parameterization of period in the model.</p>
<p>The values within <code>decay_params</code> must be a set within
<code>main_params</code> as, for example, we can’t model the decay in
period, without modeling the starting period. The default is to not
model decay of any rhythmic characteristics:
<code>decay_params=c()</code>.</p>
<p>Additional possible arguments in the <code>control</code> list
are:</p>
<ul>
<li>
<code>period_param</code> adds <code>"tau"</code> to the
<code>main_params</code> if <code>TRUE</code>; default:
<code>period_param=FALSE</code>.</li>
<li>
<code>period_min</code> estimated bottom range for period starting
values when performing nonlinear regression; default:
<code>period_min=20</code>.</li>
<li>
<code>period_max</code> estimated upper range for period starting
values when performing nonlinear regression;
<code>period_max=28</code>,</li>
</ul>
<p>If you are modeling non-circadian (but still rhythmic) data, with a
much larger or smaller period than 24 hours, and you want to have the
model estimate the period (<code>tau</code>) you can change
<code>period_min</code> and <code>period_max</code> to more realistic
ranges. This may reduce the time required for the model to converge.</p>
<p>Note that when adding parameters to <code>decay_params</code>, you
should call the name of the parameter in as it is in main_params -
<code>decay_params=c("k")</code>, for example. This will add a new
parameter <code>k_decay</code> to the model. If you want to add a
grouping parameter to this decay parameter, you need to call the decay
of mesor explicitly, <code>group_params=c("k_decay")</code>, as
<code>"k"</code> alone would be referring to the mesor value, not the
decay of mesor over time.</p>
<p>Similarly, when adding parameters as random-effects by adding to
<code>rand_params</code>, we need to call the parameter name (including
it’s suffix: “<code>_decay</code>” for decay parameters and
“<code>1</code>” for group parameters, or “<code>_decay1</code>” for
grouped decay parameters). If I wanted to fit a model with the default
<code>main_params</code> as well as period (<code>tau</code>), a decay
in mesor (<code>k</code>), and grouping on mesor decay rate, amplitude
and phase, but not starting mesor:</p>
<p><code>control=list(main_params=c("k", "alpha", "phi", "tau"), decay_params=c("k"), group_params=c("k_decay", "alpha", "phi"))</code></p>
<p>The resulting model will assume that both groups have a shared mesor
and period as <code>"k"</code> and <code>"tau"</code>, respectively, are
excluded from <code>group_params</code>. The model will estimate the
period from the data. It will model the exponential decay in mesor as
well as the influence of group assignment on this rate of decay.</p>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>If you have repeated measures data, then it may be inappropriate to
use a standard fixed effects only model. In this case, you should use a
mixed model, with context-relevant random effects for the
ID/subjects/mice from which you’re obtaining repeated observations.</p>
<p>Here, I have some data that has some simulated within-id correlation
in terms of the amount of phase shift between groups.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phi1_in</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">mixed_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">counter</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_data.html">make_data</a></span><span class="op">(</span>k1 <span class="op">=</span> <span class="fl">0</span>, alpha1 <span class="op">=</span> <span class="fl">5</span>, phi1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">phi1_in</span>, <span class="fl">1</span><span class="op">)</span>, hours <span class="op">=</span> <span class="fl">72</span>, noise_sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">x</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="va">counter</span></span>
<span>    <span class="va">counter</span> <span class="op">&lt;-</span> <span class="va">counter</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">res</span>, <span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">mixed_data</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/circacompare_mixed.html">circacompare_mixed</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">df</span>,</span>
<span>  col_time <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  col_group <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  col_outcome <span class="op">=</span> <span class="st">"measure"</span>,</span>
<span>  col_id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>grouped_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"phi"</span><span class="op">)</span>, random_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"phi1"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  period <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  suppress_all <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>, <span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">measure</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, <span class="va">group</span><span class="op">)</span><span class="op">)</span>, span <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">id</span><span class="op">)</span></span></code></pre></div>
<p><img src="circacompare_files/figure-html/unnamed-chunk-7-1.png" width="480"></p>
<p>For each subject (<code>id</code>), there are measurements in both
groups (<code>g1</code> and <code>g2</code>) but the degree of change in
phase between <code>g1</code> to <code>g2</code> is subject-dependent.
The phase of group 1 is not subject-dependent, though, as each subject
has approximately the same phase in <code>g1</code>. However, it’s the
amount of phase shift from <code>g1</code> to <code>g2</code> that is
subject-dependent. This is equivalent to each subject having a random
slope term but not a random intercept. In an experimental context, this
could be the case when mice are kept under light-dark (LD) conditions
<code>g1</code> and then moved to constant conditions (LL or DD),
<code>g2</code>. We would expect the phase to be consistent under the
same conditions in <code>g1</code> but the change in phase when they are
moved to LL or DD could be mouse-dependent.</p>
<p>In this scenario, we want to have a “random-slope” on the phase, so
we should include <code>phi1</code> as a random effect. Also, since we
know (from the data generating process) that both groups share the same
mesor but not amplitude, we included <code>alpha</code> and
<code>phi</code> as grouped parameters, but excluded <code>k</code>. We
also know that the period is 24 hours, so we didn’t bother fitting a
parameter period either (adding <code>"tau"</code> to
<code>main_params</code>) so we left <code>main_params</code> at its
default value: <code>main_params=c("k", "alpha", "phi")</code>. In the
code above, we used:
<code>control=list(grouped_params=c("alpha", "phi"), random_params=c("phi1"))</code></p>
<p>From the data generating process used above, we expect:</p>
<ul>
<li><code>phi1=3</code></li>
<li><code>alpha1=5</code></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="circacompare_files/figure-html/unnamed-chunk-8-1.png" width="480"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">circacompare</span><span class="fu">:::</span><span class="fu">extract_model_coefs</span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">summary</span><span class="op">$</span><span class="va">`95% CI ll`</span> <span class="op">&lt;-</span> <span class="va">summary</span><span class="op">$</span><span class="va">estimate</span> <span class="op">-</span> <span class="va">summary</span><span class="op">$</span><span class="va">std_error</span> <span class="op">*</span> <span class="fl">1.96</span></span>
<span><span class="va">summary</span><span class="op">$</span><span class="va">`95% CI ul`</span> <span class="op">&lt;-</span> <span class="va">summary</span><span class="op">$</span><span class="va">estimate</span> <span class="op">+</span> <span class="va">summary</span><span class="op">$</span><span class="va">std_error</span> <span class="op">*</span> <span class="fl">1.96</span></span>
<span></span>
<span><span class="va">summary</span></span>
<span><span class="co">#&gt;            estimate   std_error      p_value    95% CI ll   95% CI ul</span></span>
<span><span class="co">#&gt; k      -0.030108418 0.037543899 4.226472e-01 -0.103694459  0.04347762</span></span>
<span><span class="co">#&gt; alpha   9.973999567 0.075087709 0.000000e+00  9.826827657 10.12117148</span></span>
<span><span class="co">#&gt; phi     0.005516318 0.007528311 4.637752e-01 -0.009239171  0.02027181</span></span>
<span><span class="co">#&gt; alpha1  5.099811194 0.106190057 0.000000e+00  4.891678682  5.30794370</span></span>
<span><span class="co">#&gt; phi1    2.992445863 0.193146837 4.776699e-52  2.613878062  3.37101366</span></span></code></pre></div>
<p>The effects were all pretty well estimated, given the 95% confidence
intervals from the model outputs. If we expect the subject’s to have
different starting phases but their change in phase between groups to be
the same, we may have put the random effect on <code>phi</code> rather
than <code>phi1</code>.</p>
<p>Perhaps more commonly applicable would be if each subject has some
random mesor or baseline expression level. In this case, it may be
worthwhile to include <code>k</code> as a random effect. If
<code>k</code> is included, this is equivalent to giving all subjects a
“random intercept” as baseline levels of the outcome for each subject
will be the random effect.</p>
</div>
</div>
<div class="section level2">
<h2 id="period-and-decay-parameters">Period and decay parameters<a class="anchor" aria-label="anchor" href="#period-and-decay-parameters"></a>
</h2>
<p>There is the option to add parameters to represent the decay of any
rhythmic characteristic as well as the difference between groups for
this decay. For model below, we make simulated data with no difference
in mesor or phase between groups, a randomly generated period between 8
and 20 hours that we want to estimate (and will check at the end). We
also have one group which has exponentially decaying amplitude at the
rate:</p>
<p><span class="math display">\[
\alpha*e^{-\alpha_{decay}*t}
\]</span> Where <code>alpha</code> is the amplitude, and <code>t</code>
is time in radian-hours.</p>
<p>In our case, <code>alpha_decay</code> will be another randomly
generated value, somewhere between 0.02 and 0.05, that we will check at
the end.</p>
<p>To model these data, we will include all the standard parameters as
well as <code>tau</code> (to estimate the period) in the
<code>main_params</code>:
<code>main_params=c("k", "alpha", "phi", "tau")</code></p>
<p>We will include the term for amplitude (<code>alpha</code>) in the
<code>decay_params</code>: <code>decay_params=c("alpha")</code></p>
<p>And we will model the differences between groups for both the
starting amplitude,<code>alpha</code>, and its decay over time
<code>alpha_decay</code>:
<code>grouped_params=c("alpha", "alpha_decay")</code></p>
<p>This produces the following model:</p>
<p><code>measure~k+((alpha+alpha1*x_group)*exp(-(alpha_decay+alpha_decay1*x_group)*time_r))*cos((24/(tau))*time_r-(phi))</code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tau_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">alpha_decay1_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.02</span>, <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_data.html">make_data</a></span><span class="op">(</span>k1 <span class="op">=</span> <span class="fl">0</span>, alpha1 <span class="op">=</span> <span class="fl">10</span>, phi1 <span class="op">=</span> <span class="fl">0</span>, seed <span class="op">=</span> <span class="fl">42</span>, hours <span class="op">=</span> <span class="fl">120</span>, noise_sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">time</span> <span class="op">/</span> <span class="fl">24</span> <span class="op">*</span> <span class="va">tau_in</span></span>
<span></span>
<span><span class="co"># Note that when decay is estimated, it is on a scale of time in hours. There is no relation decay rate and the period.</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">measure</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"g2"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">measure</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"g2"</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">alpha_decay1_in</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"g2"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">out_alpha_decay</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/circacompare.html">circacompare</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">df</span>, <span class="st">"time"</span>, <span class="st">"group"</span>, <span class="st">"measure"</span>, period <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      main_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"k"</span>, <span class="st">"alpha"</span>, <span class="st">"phi"</span>, <span class="st">"tau"</span><span class="op">)</span>,</span>
<span>      decay_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha"</span><span class="op">)</span>,</span>
<span>      grouped_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"alpha_decay"</span><span class="op">)</span>,</span>
<span>      period_min <span class="op">=</span> <span class="fl">2</span>, period_max <span class="op">=</span> <span class="fl">24</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   step factor 0.000488281 reduced below 'minFactor' of 0.000976562</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   step factor 0.000488281 reduced below 'minFactor' of 0.000976562</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   number of iterations exceeded maximum of 50</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   step factor 0.000488281 reduced below 'minFactor' of 0.000976562</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   number of iterations exceeded maximum of 50</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   number of iterations exceeded maximum of 50</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   step factor 0.000488281 reduced below 'minFactor' of 0.000976562</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   number of iterations exceeded maximum of 50</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   step factor 0.000488281 reduced below 'minFactor' of 0.000976562</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   step factor 0.000488281 reduced below 'minFactor' of 0.000976562</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="co">#&gt; Error in stats::nls(formula = form, data = data, start = starting_params,  : </span></span>
<span><span class="co">#&gt;   singular gradient</span></span>
<span></span>
<span><span class="va">out_alpha_decay</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<p><img src="circacompare_files/figure-html/unnamed-chunk-9-1.png" width="480"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">circacompare</span><span class="fu">:::</span><span class="fu">extract_model_coefs</span><span class="op">(</span><span class="va">out_alpha_decay</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">summary</span><span class="op">$</span><span class="va">`95% CI ll`</span> <span class="op">&lt;-</span> <span class="va">summary</span><span class="op">$</span><span class="va">estimate</span> <span class="op">-</span> <span class="va">summary</span><span class="op">$</span><span class="va">std_error</span> <span class="op">*</span> <span class="fl">1.96</span></span>
<span><span class="va">summary</span><span class="op">$</span><span class="va">`95% CI ul`</span> <span class="op">&lt;-</span> <span class="va">summary</span><span class="op">$</span><span class="va">estimate</span> <span class="op">+</span> <span class="va">summary</span><span class="op">$</span><span class="va">std_error</span> <span class="op">*</span> <span class="fl">1.96</span></span>
<span><span class="va">summary</span><span class="op">$</span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">summary</span></span>
<span><span class="co">#&gt;                   estimate    std_error    95% CI ll    95% CI ul</span></span>
<span><span class="co">#&gt; k            -3.395691e-02 0.1013869255 -0.232675281  0.164761467</span></span>
<span><span class="co">#&gt; alpha         1.009223e+01 0.4052065165  9.298025134 10.886434679</span></span>
<span><span class="co">#&gt; alpha_decay   5.435973e-05 0.0007432627 -0.001402435  0.001511155</span></span>
<span><span class="co">#&gt; alpha1        8.632203e+00 0.8813658989  6.904725702 10.359680026</span></span>
<span><span class="co">#&gt; alpha_decay1  3.739104e-02 0.0023140206  0.032855564  0.041926524</span></span>
<span><span class="co">#&gt; tau           1.850420e+01 0.0327072885 18.440090205 18.568302776</span></span>
<span><span class="co">#&gt; phi           1.338657e-02 0.0270874943 -0.039704918  0.066478060</span></span></code></pre></div>
<p>We now have estimates and 95% confidence intervals for the difference
in amplitude decay between groups (<code>alpha_decay1</code>) and the
period (<code>tau</code>) that were of interest. Lets see the values we
used to generate the data and check that the confidence intervals were
appropriate.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Real period: "</span>, <span class="va">tau_in</span>, <span class="st">"\n"</span>,</span>
<span>  <span class="st">"Real alpha_decay: "</span>, <span class="va">alpha_decay1_in</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Real period: 18.50667</span></span>
<span><span class="co">#&gt; Real alpha_decay: 0.03999372</span></span></code></pre></div>
<p>Looks like our estimates and confidence intervals suited our
now-known data generating process well!</p>
</div>
<div class="section level2">
<h2 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h2>
<div class="section level3">
<h3 id="decay-functions">Decay functions<a class="anchor" aria-label="anchor" href="#decay-functions"></a>
</h3>
<p>Currently, decay parameters are used to model exponential decay as
this seemed sensible for most biological contexts. However, users may
want to model decay as a linear (or some other) function. There is no
implementation for this in the current package. If this is of interest
to you, please contact me or create an issue on GitHub.</p>
</div>
<div class="section level3">
<h3 id="period-and-phase-parameters">Period and phase parameters<a class="anchor" aria-label="anchor" href="#period-and-phase-parameters"></a>
</h3>
<p>It may be tempting to investigate the differences between two groups
of rhythmic data regarding everything! But, unfortunately, there are
limitations. If two groups of data are allowed to vary regarding their
period, the interpretation of a difference in phase is no longer
appropriate. For example, if two rhythms have different periods, at what
time are you wanting to know the difference in phase between the groups?
The amount of phase-shift will differ over time if they have different
periods. For this reason, you cannot have both <code>tau</code> and
<code>phi</code> within <code>group_params</code> in either
<code><a href="../reference/circacompare.html">circacompare()</a></code> or <code><a href="../reference/circacompare_mixed.html">circacompare_mixed()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="model-diagnostics-and-choice">Model diagnostics and choice<a class="anchor" aria-label="anchor" href="#model-diagnostics-and-choice"></a>
</h3>
<p>When using circa_single() or circacompare() a nonlinear regression
model (with fixed-effects only) of class <code>nls</code> is fit. When
using circa_single_mixed() or circacompare_mixed() a nonlinear mixed
regression model of class <code>nlme</code> is fit. Users should be
aware of the assumptions of these models when interpreting the results.
See <a href="https://doi.org/10.18637/jss.v066.i05" class="external-link">here</a> for a
thorough discussion of model assumptions and performing diagnostic tests
using the <a href="https://github.com/aursiber/nlstools" class="external-link">nlstools</a> package.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rex Parsons.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
